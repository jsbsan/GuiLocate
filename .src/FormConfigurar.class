' Gambas class file

Private DirectorioAntesCambios As String = Settings["DirectorioInicial", User.home]

Public Sub Form_Open()

  actualizarInformacion()

End

Public Sub actualizarInformacion()

  Dim contenido As String

  Shell "locate --statistics" To contenido

  TextLabelEstadisticas.text = Replace(contenido, "\n", "<br>")

  Me.Center

End

'

Public Sub ButtonAplicar_Click()

  Me.Close

End

Public Sub ButtonActualizarBaseDatos_Click()
  ''fuente: https://www.gambas-es.org/viewtopic.php?p=11658#p11658

  Dim contra As String

  contra = InputBox("Introduce contrase√±a de administrador")

  Application.Busy = 1

  Shell "echo \"" & contra & "\"|sudo -S updatedb" Wait
  actualizarInformacion()
  Application.Busy = 0

  Message.Info("Actualizada la base de datos")

End
